# ~/.tmux.conf
# By Tyler Mulligan. Public domain.
#
# This configuration file binds many of the common GNU screen key bindings to
# appropriate tmux key bindings. Note that for some key bindings there is no
# tmux analogue and also that this set omits binding some commands available in
# tmux but not in screen.
#
# Note this is a good starting point but you should check out the man page for more
# configuration options if you really want to get more out of tmux
 
set -g default-terminal "screen" 

# Set the prefix to ^A.
unbind C-b
set -g prefix C-a
bind a send-prefix

# Bind appropriate commands similar to screen.
# screen ^C 
unbind ^C
bind c neww -c '#{pane_current_path}'

# detach ^D d
unbind ^D
bind ^D detach
 
# displays *
unbind *
bind * list-clients
 
# next N
unbind ^N
bind ^N next-window
 
# other ^A
unbind ^A
bind ^A last-window
 
# prev p 
unbind p
bind p previous-window
 
# windows ^W w
unbind ^W
bind ^W list-windows
unbind w
bind w list-windows
 
# quit \
unbind \
bind \ confirm-before "kill-server"
 
# kill K k
unbind K
bind K confirm-before "kill-window"
unbind k
bind k confirm-before "kill-window"
 
# redisplay ^L l
unbind ^L
bind ^L refresh-client
unbind l
bind l refresh-client
 
# More straight forward key bindings for splitting
unbind %
bind | split-window -h -c '#{pane_current_path}'
bind v split-window -h -c '#{pane_current_path}'
unbind '"'
bind - split-window -v -c '#{pane_current_path}'
bind h split-window -v -c '#{pane_current_path}'
 
# History
set -g history-limit 1000
 
# Status Bar
set -g status-bg black
set -g status-fg white
set -g status-interval 1
set -g status-left '#[fg=green]#H#[default]'
set -g status-right '#[fg=yellow]#(cut -d " " -f 1-4 /proc/loadavg)#[default] #[fg=cyan,bold]%Y-%m-%d %H:%M:%S#[default]'

# Notifying if other windows has activities
setw -g monitor-activity on
set -g visual-activity on
 
# Highlighting the active window in status bar
setw -g window-status-current-bg blue
setw -g window-status-current-fg black
 
# Clock
setw -g clock-mode-colour green
setw -g clock-mode-style 24
 
# " windowlist -b
unbind '"'
bind '"' choose-window

# enable mouse for panes
# * Mouse
# setw  -g mode-mouse on # incompatible in tmux 2.1+
set -g mouse on

# ** Drag pane border to resize
# set   -g mouse-resize-pane off # incompatible in tmux 2.1+
# bind -T root MouseDrag1Border resize-pane -M # default
#unbind -T root MouseDrag1Border # disable drag pane border to resize

bind -T root MouseDrag1Pane if -Ft= '#{mouse_any_flag}' 'if -Ft= "#{pane_in_mode}" "copy-mode -M" "send-keys -M"' 'copy-mode -M' # default

# ** Left click on pane
# set   -g mouse-select-pane on # incompatible in tmux 2.1+
# Left click on a pane selects it
# bind -T root MouseDown1Pane select-pane -t=\; send-keys -M # default
bind -T root MouseDown1Pane select-pane -t=

unbind -temacs-copy MouseDown1Pane
unbind -temacs-copy MouseUp1Pane
# Left click in the pane followed after a region selection copies that selection
# to the clipboard using xclip
bind -T root MouseUp1Pane run -b "tmux show-buffer | xclip -i"

# ** Right click on pane
# Right click on a pane selects and marks it *if not in copy-mode*; else
# passes on the mode keys
# bind -T root MouseDown3Pane select-pane -t= -m # default
bind -T root MouseDown3Pane if -Ft= '#{pane_in_mode}' 'send-keys -M' 'select-pane -t= -m'
# Right click *release* on a pane *in copy-mode* quits copy-mode
bind -temacs-copy MouseUp3Pane cancel

# ** Wheel scroll in pane
unbind -T root WheelUpPane
unbind -T root WheelDownPane
# Do mouse wheel-up to enter copy mode and do page-up
# https://groups.google.com/d/msg/tmux-users/XTrSVUR15Zk/3iyJLMyQ7PwJ
# Below binding did not work
#   bind -T root WheelUpPane if -Ft= '#{mouse_any_flag}' 'if -Ft= "#{pane_in_mode}" "copy-mode -u" "send-keys -M"' 'copy-mode -u'
# Below works and allows the WheelUpPane binding in emacs-copy table to be effective
bind -T root WheelUpPane if -Ft= '#{mouse_any_flag}' 'send-keys -M' 'if -Ft= "#{pane_in_mode}" "send-keys -M" "copy-mode -u"'
# |---------------------+-----------------------------------------+--------------------------------|
# | using mouse? AND .. | #{pane_in_mode} (already in copy-mode?) | action                         |
# |---------------------+-----------------------------------------+--------------------------------|
# | Yes                 | Don't care                              | Send the mode keys             |
# | No                  | Yes                                     | Send the mode keys             |
# | No                  | No                                      | Enable copy-mode and do PageUp |
# |---------------------+-----------------------------------------+--------------------------------|

# *** Wheel scroll in pane WHILE in copy-mode
# Once in copy-mode, mouse wheel scrolls scrolls by half pages
bind -temacs-copy WheelUpPane   halfpage-up
bind -temacs-copy WheelDownPane halfpage-down

# ** Left click on status
# set   -g mouse-select-window on # incompatible in tmux 2.1+
# Left click on a window name in status bar to select it
bind -T root MouseDown1Status select-window -t= # default

# ** Middle click on status
# Middle click on a window name in status bar to kill it
bind -T root MouseDown2Status kill-window
# Middle click in a pane to paste
bind -T root MouseDown2Pane run -b "exec </dev/null; xclip -o | awk 1 ORS=' ' | tmux load-buffer - ; tmux paste-buffer"

# The special token ‘{mouse}’ or ‘=’ may be used as target-window or target-pane in
# commands bound to mouse key bindings. Example: -t =


# set vi key bindings
setw -g mode-keys vi
#bind p paste-buffer
bind-key -t vi-copy 'v' begin-selection
bind-key -t vi-copy 'y' copy-selection

# don't rename automatically
setw -g automatic-rename off 


# ** Window Status Colors
setw  -g window-status-style          default # default for all window statuses
setw  -g window-status-last-style     fg=default,bg=colour235
setw  -g window-status-current-style  fg=white,bold,bg=colour63
setw  -g window-status-bell-style     default
setw  -g window-status-activity-style fg=white,none,bg=colour196
# setw  -g window-status-content-style  fg=black,none,bg=green # incompatible with tmux 2.0+

# ** Pane Colors
set   -g pane-active-border-style     fg=colour63,bg=default
set   -g pane-border-style            fg=colour235,bg=default
setw  -g window-style          'bg=black' # bg color of active pane
setw  -g window-active-style                 'bg=#101010' # bg color of inactive pane(s)

# ** Mode Info Colors
# Color of display shown on top-right in copy-mode, highlighting
setw  -g mode-style                   fg=black,bg=colour244


